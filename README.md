SADLN

## Introduction

 SADLN: a self-attention based deep learning network integrating multi-omics data for cancer subtype recognition. SADLN is a middle integration method by consolidates the adversarial generation network and the self-attention mechanism to describe the different distributions of multi-omics data and fusion samplesâ€™ relationship. It used an independent sub network to learn omics-specific features and concatenated omics-specific features to an integration representation. Then used a self-attention to learn the relationship of samples on the integration representation and obtained a feature representation that fused the sample relationship. Finally, it used the Gaussian Mixture Model (GMM) to obtain the subtyping label of each sample.

## Files

fea, input: Input multi-omics data of SADLN

results: Output of SADLN

SADLN.py: Examples of SADLN for subtyping and cluster

transformer.py: Section of self-attention network 

decisiontree.py: Section of calculating the contribution of single-omics

p_value.R: Section of P-value calculation  in survival analysis

clinlc_analysis.R: Section of clinical parameters enrichment analysis

## Requirements

+ python = 3.6.7
+ tensorflow = 1.14.0
+ pandas = 1.3.5
+ numpy = 1.19.2
+ sklearn = 0.22
+ keras = 2.2.4
+ matplotlib = 3.5.2

~~~python
# It is recommended to use the conda command to configure the environment:
conda env create -f environment.yml
~~~

SADLN is based on the Python program language. 

## Usage

Overall architecture of SADLN shown follows:

![Figure1](Figure1.jpg)

SADLN's main network design in the figure above is deployed in `SADLN.py`, with the exception of the self attention model deployed in `transformer.py`. The training part of SADLN is deployed in `SADLN.py`

In the following, we use BRCA as an example to describe the project training process and result analysis in detail. 

**Firstly**, the pre-processed data is stored in `fea/BRCA`. The shape of input data is $N\times D$, where $N$ represents the number of samples and $D$ represents the number of features. The code reads the three omics data through the path stored in the `input/BRCA.list`.

In the `main` of `SADLM.py`, we design a `ArgumentParser` that can select different models or different data sets by input corresponding commands.  it can be used to adjust the parameters of the model at the same time. The parameters involved in the parser are as follows:

```python
    parser = argparse.ArgumentParser(description='SADLN v1.0') 
    parser.add_argument("-i", dest='file_input', default="./input/input.list",  help="file input")
    parser.add_argument("-e", dest='epochs', type=int, default=200, help="Number of iterations") 
    parser.add_argument("-m", dest='run_mode', default="feature", help="run_mode: feature, cluster") 
    parser.add_argument("-w", dest='disc_weight', type=float, default=1e-4, help="weight")
    parser.add_argument("-o", dest='output_path', default="./score/", help="file output")
    parser.add_argument("-p", dest='other_approach', default="spectral", help="kmeans, spectral, tsne_gmm, tsne")
    parser.add_argument("-s", dest='surv_path',
                        default="./data/TCGA/clinical_PANCAN_patient_with_followup.tsv",
                        help="surv input")
    parser.add_argument("-t", dest='type', default="ALL", help="cancer type: BRCA, GBM")
    parser.add_argument("-cn", dest='cluster_num', default=-1,  help="surv input")
    args = parser.parse_args()
```

For example

~~~python
# the input list of BRCA omics data set is input.txt. We can use the following command to finish the subtyping process: 
python SADLN.py -m SADLN -t BRCA -i ./input/BRCA.list
~~~

The command indicates that the selected model is `SADLN`, the selected dataset is `BRCA`, and the address of the input data is `./input/ BRCA.list`.

**Secondly**, this program operation outputs two operation results, one is  the feature generated by GAN network in `fea`, the shape of feature is $N\times d$, $d$ represents the set of feature dimension. The other is the clustering result `BRCA.SADLN`, which is stored in `result`.

**Finally,** the output features and clustering results can be used to do related visualization and analysis.

- By running `SDLAN.py` with the following parameters, `tSNE` will be used to reduce the dimension of the output features and the clustering results can be used to output the clustering scatter plot of `BRCA`.

  ```python
  python SADLN.py -m show -t BRCA -i ./input/BRCA.list
  ```

  

- `decisiontree.py` is used to calculate the score of each feature and get the contribution degree and key biomarkers of each omics. The input data is the concatenation of the single-omics original feature data of `BRCA`  and the clustering results.

- `p_value.R` is used to calculate the p-values of survival analysis. The input data is the clustering results and , survival data can be get from result/.`BRCA.clinic`.

- clinlc_analysis.R is used to calculate the p-values of clinlc analysis. The input data is the clustering results and , survival data can be get from result/.`BRCA.clinic`.
